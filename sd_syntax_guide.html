<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stable Diffusion 構文ルール＆制御タグ 完全ガイド</title>
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />
    <style>
      body {
        font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN",
          "Hiragino Sans", Meiryo, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f8f9fa;
      }
      h1 {
        color: #2c3e50;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
        text-align: center;
      }
      h2 {
        color: #2980b9;
        background: #eaf2f8;
        padding: 10px 15px;
        border-left: 5px solid #2980b9;
        margin-top: 30px;
      }
      h3 {
        color: #d35400;
        border-bottom: 1px solid #ddd;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background: #fff;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }
      th {
        background-color: #3498db;
        color: white;
      }
      code {
        background-color: #f1f1f1;
        padding: 2px 5px;
        border-radius: 4px;
        font-family: "Courier New", Courier, monospace;
        font-weight: bold;
        color: #e83e8c;
      }
      .example {
        background-color: #fff3cd;
        border-left: 5px solid #ffc107;
        padding: 15px;
        margin: 10px 0;
      }
      .note {
        background-color: #d1ecf1;
        border-left: 5px solid #0c5460;
        padding: 15px;
        margin: 10px 0;
        font-size: 0.9em;
      }
      ul {
        padding-left: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Stable Diffusion 構文ルール＆制御タグ ガイド</h1>

    <p>
      Stable
      Diffusion（特にAUTOMATIC1111/Forge環境）で理想の画像を生成するための、プロンプトの記述ルールと特殊な制御方法をまとめています。
    </p>

    <h2>1. 基本的な記述ルール</h2>
    <ul>
      <li>
        <strong>カンマ区切り:</strong> 各タグ（キーワード）は半角カンマ
        <code>,</code> で区切ります。
      </li>
      <li>
        <strong>優先順位:</strong>
        プロンプトの先頭に近い単語ほど、画像に強く反映されます。
      </li>
      <li>
        <strong>Danbooruタグの活用:</strong>
        アニメ系モデルの場合、<code>1girl</code>,
        <code>solo</code> などのDanbooru形式のタグが最も効果的です。
      </li>
    </ul>

    <h2>2. 強調・重み付け（Attention/Weight）</h2>
    <p>特定の要素を強く出したい、あるいは弱めたい場合に使用します。</p>
    <table>
      <tr>
        <th>構文</th>
        <th>効果</th>
        <th>説明</th>
      </tr>
      <tr>
        <td><code>(word)</code></td>
        <td>1.1倍強調</td>
        <td>
          丸括弧で囲むと強調されます。重ねるほど強くなります
          <code>((word))</code>。
        </td>
      </tr>
      <tr>
        <td><code>[word]</code></td>
        <td>0.9倍弱化</td>
        <td>角括弧で囲むと影響力が弱まります。</td>
      </tr>
      <tr>
        <td><code>(word:数値)</code></td>
        <td>倍率指定</td>
        <td><code>(red flower:1.5)</code> のように記述。1.0が標準です。</td>
      </tr>
    </table>
    <div class="note">
      ※
      数値を上げすぎると（1.5以上など）、画像が崩れる（アーティファクトが出る）原因になります。
    </div>

    <h2>3. プロンプト・エディティング（Scheduling）</h2>
    <p>
      生成の途中でプロンプトを切り替えたり、特定のステップから要素を導入したりする高度な手法です。
    </p>

    <h3>■ 切り替え（Switching）</h3>
    <p><code>[from:to:step]</code></p>
    <div class="example">
      例：<code>[pink hair:blue hair:10]</code><br />
      最初の10ステップまでは「桃色の髪」を描き、それ以降は「青色の髪」として描画します。
    </div>

    <h3>■ 導入（Starting）</h3>
    <p><code>[to:step]</code></p>
    <div class="example">
      例：<code>[glasses:15]</code><br />
      15ステップ目から「メガネ」の要素を書き込み始めます。背景を固めた後に小物を追加する際に有効です。
    </div>

    <h3>■ 除去（Stopping）</h3>
    <p><code>[from::step]</code></p>
    <div class="example">
      例：<code>[sketch::20]</code><br />
      20ステップ目以降は「スケッチ」の指示を無視します。構図だけスケッチ風にして、仕上げは描き込みたい時に。
    </div>

    <h2>4. 特殊な制御コマンド</h2>

    <h3>■ Alternating Words（交互生成）</h3>
    <p><code>[word1|word2]</code></p>
    <p>
      1ステップごとにword1とword2を交互に処理します。2つの要素を混ぜた「中間」を作るのに適しています。
    </p>
    <div class="example">
      例：<code>[cat|dog]</code> →
      猫と犬が混ざったような不思議な動物が生成されます。
    </div>

    <h3>■ BREAK キーワード</h3>
    <p>
      プロンプトのチャンク（塊）を強制的に区切ります。通常、SDは75トークンごとにプロンプトを区切りますが、<code
        >BREAK</code
      >
      を入れることで意図的に区切りを作り、前後のタグが混ざるのを防ぎます。
    </p>
    <div class="example">
      例：<code>1girl, red dress, BREAK, beach, sunset</code><br />
      人物の属性と背景の属性が混ざる（服の色が空に移るなど）のを抑制できます。
    </div>

    <h3>■ AND (Composable Diffusion)</h3>
    <p>複数のプロンプトを並列に計算し、合成します。</p>
    <div class="example">
      例：<code>castle:1.5 AND forest:1.0</code><br />
      「城」と「森」の概念を別々に計算して混ぜ合わせます。
    </div>

    <h2>5. 外部リソースの呼び出し</h2>
    <table>
      <tr>
        <th>種類</th>
        <th>構文</th>
        <th>説明</th>
      </tr>
      <tr>
        <td>LoRA</td>
        <td><code>&lt;lora:名前:強度&gt;</code></td>
        <td>特定の画風やキャラを適用します。強度（Weight）は通常 0.5～1.0。</td>
      </tr>
      <tr>
        <td>Embedding</td>
        <td><code>ファイル名</code></td>
        <td>
          Textual Inversion。ファイル名をプロンプトに書くだけで適用されます。
        </td>
      </tr>
      <tr>
        <td>Wildcards</td>
        <td><code>__ファイル名__</code></td>
        <td>（拡張機能が必要）リストからランダムに単語を抽出します。</td>
      </tr>
    </table>

    <div
      style="
        text-align: center;
        margin-top: 50px;
        font-size: 0.8em;
        color: #777;
      "
    >
      &copy; 2026 Stable Diffusion Prompt Engineering Guide
    </div>
  </body>
</html>
